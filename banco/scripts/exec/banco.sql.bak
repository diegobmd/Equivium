DROP TABLE ITENS_ESCOLHA        IF EXISTS;
DROP TABLE ITENS_REALIZA_SESSAO IF EXISTS;
DROP TABLE ESTIMULOS_SUB_FASE   IF EXISTS;
DROP TABLE ESTIMULOS_AUDIOS     IF EXISTS;
DROP TABLE ESTIMULOS_FIGURAS    IF EXISTS;
DROP TABLE ESTIMULOS            IF EXISTS;
DROP TABLE SESSAO_FASES         IF EXISTS;
DROP TABLE SESSOES              IF EXISTS;
DROP TABLE FASES_SUB_FASES      IF EXISTS;
DROP TABLE FASES                IF EXISTS;
DROP TABLE SUB_FASES            IF EXISTS;
DROP TABLE REFORCOS_AUDIOS      IF EXISTS;
DROP TABLE REFORCOS             IF EXISTS;
DROP TABLE REALIZA_SESSAO       IF EXISTS;
DROP TABLE PESQUISADORES        IF EXISTS;
DROP TABLE ANOTACOES            IF EXISTS;
DROP TABLE PARTICIPANTES        IF EXISTS;
DROP TABLE ESCOLARIDADE         IF EXISTS;
DROP TABLE ESTADO               IF EXISTS;
DROP TABLE ANAGRAMAS            IF EXISTS;
DROP TABLE ANAGRAMAS            IF EXISTS;
DROP TABLE ANAGRAMAS            IF EXISTS;

CREATE TABLE ANOTACOES(
	ANO_CODIGO        BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	ANO_PARTICIPANTE  BIGINT NOT NULL, 
	ANO_NOME          VARCHAR(50) NOT NULL, 
	ANO_DESCRICAO     LONGVARCHAR NOT NULL,
	ANO_DATA          DATE        NOT NULL
)


CREATE TABLE ESCOLARIDADE (
	ESC_CODIGO    INT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	ESC_DESCRICAO VARCHAR(50) NOT NULL
)


CREATE TABLE ESTADO(
	EST_SIGLA     CHAR(2) NOT NULL PRIMARY KEY,
	EST_DESCRICAO CHAR(20) NOT NULL
)

CREATE TABLE ESTIMULOS(
	EST_CODIGO 			BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	EST_SIGLA       VARCHAR(4) NOT NULL,
	EST_NOME        VARCHAR (50) NOT NULL,
	EST_AUDIO_PATH  VARCHAR(255) NOT NULL,
	EST_FIGURA_PATH VARCHAR(255) NOT NULL,
	EST_PALAVRA     VARCHAR(20) NOT NULL,
	EST_INTERVALO   DOUBLE DEFAULT 0 NOT NULL,
	EST_COR_FUNDO   INT DEFAULT 0  NOT NULL,
	EST_COR_FONTE   INT DEFAULT 0  NOT NULL
)

CREATE TABLE ESTIMULOS_AUDIOS(
	AUD_ESTIMULO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	AUD_ARQUIVO  LONGVARBINARY NOT NULL
)

CREATE TABLE ESTIMULOS_FIGURAS(
	FIG_ESTIMULO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	FIG_ARQUIVO  LONGVARBINARY NOT NULL
)

CREATE TABLE ESTIMULOS_SUB_FASE(
	EST_SUB_CODIGO                BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	EST_SUB_FASE                  BIGINT NOT NULL,
	EST_SUB_ESTIMULO_MODELO       BIGINT NOT NULL,
	EST_SUB_ESTIMULO_MODELO_TIPO  CHAR(1) NOT NULL,
	EST_SUB_ESTIMULO_ESCOLHA      BIGINT NULL,
	EST_SUB_ESTIMULO_ESCOLHA_TIPO CHAR(1) NULL
)

CREATE TABLE FASES(
	FAS_CODIGO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	FAS_NOME   CHAR(50) NOT NULL,
	FAS_SIGLA  CHAR(4) NOT NULL
)

CREATE TABLE FASES_SUB_FASES(
	SUB_FAS_CODIGO   BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	SUB_FAS_SUB_FASE BIGINT NOT NULL,
	SUB_FAS_FASE     BIGINT NOT NULL
)

CREATE TABLE ITENS_REALIZA_SESSAO(
	ITE_CODIGO           BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	ITE_SUB_FASE         BIGINT NOT NULL,
	ITE_REALIZA          BIGINT NOT NULL,
	ITE_AGRUPADOR        INT NOT NULL,
	ITE_TENTATIVA        INT NOT NULL,
	ITE_TEMPO            BIGINT NOT NULL,
	ITE_ORDEM_EXEC       INT DEFAULT 0  NOT NULL,
	ITE_SUB_INSTANCIA    INT DEFAULT 0  NOT NULL,
	ITE_MODELO           BIGINT NOT NULL,
	ITE_ESCOLHIDO        BIGINT NOT NULL,
	ITE_ESC_CORRETO      BIGINT DEFAULT 0 NOT NULL,
	ITE_ESCOLHA_1        BIGINT  NULL,
	ITE_ESCOLHA_2        BIGINT  NULL,
	ITE_ESCOLHA_3        BIGINT  NULL,
	ITE_ESCOLHA_4        BIGINT  NULL,
	ITE_ESCOLHA_5        BIGINT  NULL,
	ITE_ESCOLHA_6        BIGINT  NULL,
	ITE_MODELO_TIPO      CHAR(1) NOT NULL,
	ITE_ESCOLHIDO_TIPO   CHAR(1) NOT NULL,
	ITE_ESC_CORRETO_TIPO CHAR(1) NULL,
	ITE_ESCOLHA_1_TIPO   CHAR(1) NULL,
	ITE_ESCOLHA_2_TIPO   CHAR(1) NULL,
	ITE_ESCOLHA_3_TIPO   CHAR(1) NULL,
	ITE_ESCOLHA_4_TIPO   CHAR(1) NULL,
	ITE_ESCOLHA_5_TIPO   CHAR(1) NULL,
	ITE_ESCOLHA_6_TIPO   CHAR(1) NULL
) 
  
  
CREATE TABLE PARTICIPANTES(
	PAR_CODIGO           BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	PAR_ESCOLARIDADE     INT NOT NULL,
	PAR_PAI_ESCOLARIDADE INT NOT NULL,
	PAR_MAE_ESCOLARIDADE INT NOT NULL,
	PAR_ESTADO           CHAR(2) NOT NULL,
	PAR_NOME             VARCHAR(50) NOT NULL,
	PAR_PROJETO          VARCHAR(20) NOT NULL,
	PAR_INICIAIS         CHAR(3) NOT NULL,
	PAR_SEXO             CHAR(1) NOT NULL,
	PAR_NASCIMENTO       DATE NOT NULL,
	PAR_MAE_NOME         VARCHAR(50) NOT NULL,
	PAR_PAI_NOME         VARCHAR(50) NOT NULL,
	PAR_ENDERECO         VARCHAR(50) NOT NULL,
	PAR_COMPLEMENTO      VARCHAR(20) NULL,
	PAR_NUMERO           VARCHAR(10) NOT NULL,
	PAR_CEP              BIGINT NOT NULL,
	PAR_TELEFONE         BIGINT NOT NULL
)

CREATE TABLE PESQUISADORES(
	PES_CODIGO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	PES_NOME   VARCHAR(50) NOT NULL,
	PES_LOGIN  VARCHAR(20) NOT NULL,
	PES_SENHA  VARCHAR(20) NOT NULL
)


CREATE TABLE REALIZA_SESSAO(
	RSE_CODIGO       BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	RSE_PARTICIPANTE BIGINT NOT NULL,
	RSE_PESQUISADOR  BIGINT NOT NULL,
	RSE_DATA DATE    DEFAULT CURRENT_DATE NOT NULL 
)

CREATE TABLE REFORCOS(
	REF_CODIGO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	REF_NOME   VARCHAR(50) NOT NULL,
	REF_AUDIO  LONGVARCHAR
)

CREATE TABLE REFORCOS_AUDIOS(
	AUD_REFORCO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	AUD_ARQUIVO LONGVARBINARY NOT NULL
)

CREATE TABLE SESSAO_FASES(
	SES_FAS_CODIGO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	SES_FAS_SESSAO BIGINT NOT NULL,
	SES_FAS_FASE   BIGINT NOT NULL
)

CREATE TABLE SESSOES(
	SES_CODIGO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	SES_NOME   VARCHAR(50) NOT NULL,
	SES_SIGLA  CHAR(4) NOT NULL,
	SES_REFORCO_FIM  BIGINT NULL
)

CREATE TABLE SUB_FASES(
	SUB_CODIGO            BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	SUB_REFORCO_ACERTO    BIGINT NULL,
	SUB_REFORCO_FIM       BIGINT NULL,
	SUB_SIGLA             CHAR(4) NOT NULL,
	SUB_NOME              VARCHAR(50) NOT NULL,
	SUB_MINIMO_TENTATIVAS INT NOT NULL,
	SUB_ESTIMULOS_VEZ     INT NOT NULL,
	SUB_INTERVALO_MOD_ESC FLOAT NOT NULL,
	SUB_GRADE             INT NOT NULL,
	SUB_PORCENTAGEM       FLOAT NOT NULL
)

CREATE TABLE ANAGRAMAS(
	ANA_CODIGO            BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	ANA_SIGLA             CHAR(4) NOT NULL,
	ANA_NOME              VARCHAR(50) NOT NULL,
	ANA_REFORCO_ACERTO    BIGINT NULL,
	ANA_MINIMO_TENTATIVAS INT NOT NULL,
	ANA_PORCENTAGEM       FLOAT NOT NULL,
	ANA_INTERVALO_MOD_ESC FLOAT NOT NULL,
	ANA_EXTRA_VEZ     	  INT NOT NULL	
)

CREATE TABLE ANAGRAMA_ESTIMULOS(
	ANA_EST_CODIGO    BIGINT NOT NULL,
	ANA_EST_ESTIMULO  BIGINT NOT NULL,
	ANA_EST_TIPO      BIGINT NOT NULL
)

CREATE TABLE ANAGRAMA_ESTI_EXTRA(
	ANA_EST_EXT_CODIGO    BIGINT NOT NULL,
	ANA_EST_EXT_ESTIMULO  BIGINT NOT NULL
)


CREATE TABLE SESSAO_ANAGRAMA(
	SES_ANA_SESSAO 		BIGINT NOT NULL,
	SES_ANA_ANAGRAMA   	BIGINT NOT NULL
)

CREATE TABLE SESSOES_ANAGRAMA(
	SAN_CODIGO BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	SAN_NOME   VARCHAR(50) NOT NULL,
	SAN_SIGLA  CHAR(4) NOT NULL,
	SAN_REFORCO_FIM  BIGINT NULL
)

CREATE TABLE REALIZA_ANAGRAMA(
	RAN_CODIGO       BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	RAN_PARTICIPANTE BIGINT NOT NULL,
	RAN_PESQUISADOR  BIGINT NOT NULL,
	RAN_DATA DATE    DEFAULT CURRENT_DATE NOT NULL 
)


CREATE TABLE ITENS_REALIZA_ANAGRAMA(
	IAN_CODIGO           BIGINT GENERATED BY DEFAULT AS IDENTITY (START WITH 1, INCREMENT BY 1) PRIMARY KEY,
	IAN_REALIZA          BIGINT NOT NULL,
	IAN_ANAGRAMA         BIGINT NOT NULL,
	IAN_ANA_INSTANCIA    INT DEFAULT 0  NOT NULL,
	IAN_MODELO           BIGINT NOT NULL,
	IAN_MODELO_TIPO      CHAR(1) NOT NULL,
	IAN_RESULTADO        VARCHAR(10) NOT NULL,
	IAN_TENTATIVA        INT NOT NULL,
	IAN_TEMPO            BIGINT NOT NULL,
	IAN_ORDEM_EXEC       INT DEFAULT 0  NOT NULL
) 


ALTER TABLE SESSOES         	 ADD  FOREIGN KEY(SES_REFORCO_FIM) 			REFERENCES REFORCOS (REF_CODIGO)       ON UPDATE CASCADE ON DELETE NO ACTION ;
ALTER TABLE SESSOES_ANAGRAMA     ADD  FOREIGN KEY(SES_ANA_ANAGRAMA) 		REFERENCES REFORCOS (REF_CODIGO)       ON UPDATE CASCADE ON DELETE NO ACTION ;

ALTER TABLE SESSAO_ANAGRAMA      ADD  FOREIGN KEY(SES_ANA_SESSAO) 	        REFERENCES SESSOES (SES_CODIGO)        ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE SESSAO_ANAGRAMA      ADD  FOREIGN KEY(SES_ANA_FASE) 	        REFERENCES ANAGRAMAS (ANA_CODIGO)       ON UPDATE CASCADE ON DELETE CASCADE ;

ALTER TABLE PARTICIPANTES        ADD  FOREIGN KEY(PAR_ESTADO) 				REFERENCES ESTADO (EST_SIGLA)          ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE ESTIMULOS_SUB_FASE   ADD  FOREIGN KEY(EST_SUB_ESTIMULO_MODELO)  REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE ESTIMULOS_SUB_FASE   ADD  FOREIGN KEY(EST_SUB_ESTIMULO_ESCOLHA) REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE ESTIMULOS_SUB_FASE   ADD  FOREIGN KEY(EST_SUB_FASE) 			REFERENCES SUB_FASES (SUB_CODIGO)      ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE ESTIMULOS_FIGURAS    ADD  FOREIGN KEY(FIG_ESTIMULO) 			REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE ESTIMULOS_AUDIOS     ADD  FOREIGN KEY(AUD_ESTIMULO) 			REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE FASES_SUB_FASES      ADD  FOREIGN KEY(SUB_FAS_FASE  ) 			REFERENCES FASES (FAS_CODIGO)          ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE FASES_SUB_FASES      ADD  FOREIGN KEY(SUB_FAS_SUB_FASE) 		REFERENCES SUB_FASES (SUB_CODIGO)      ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE SESSAO_FASES         ADD  FOREIGN KEY(SES_FAS_FASE) 			REFERENCES FASES (FAS_CODIGO)          ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE SESSAO_FASES         ADD  FOREIGN KEY(SES_FAS_SESSAO) 	        REFERENCES SESSOES (SES_CODIGO)        ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE ANOTACOES            ADD  FOREIGN KEY(ANO_PARTICIPANTE)         REFERENCES PARTICIPANTES (PAR_CODIGO)  ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE REALIZA_SESSAO       ADD  FOREIGN KEY(RSE_PARTICIPANTE)         REFERENCES PARTICIPANTES (PAR_CODIGO)  ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE REALIZA_SESSAO       ADD  FOREIGN KEY(RSE_PESQUISADOR )         REFERENCES PESQUISADORES (PES_CODIGO)  ON UPDATE CASCADE ON DELETE NO ACTION;
ALTER TABLE REFORCOS_AUDIOS      ADD  FOREIGN KEY(AUD_REFORCO) 			    REFERENCES REFORCOS (REF_CODIGO)       ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE SUB_FASES            ADD  FOREIGN KEY(SUB_REFORCO_ACERTO)       REFERENCES REFORCOS (REF_CODIGO)       ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE SUB_FASES            ADD  FOREIGN KEY(SUB_REFORCO_FIM)  	    REFERENCES REFORCOS (REF_CODIGO)       ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_REALIZA) 				REFERENCES REALIZA_SESSAO (RSE_CODIGO) ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_ESCOLHIDO) 			REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_MODELO) 				REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE CASCADE ;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_ESC_CORRETO)          REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE NO ACTION;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_ESCOLHA_1)            REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE NO ACTION;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_ESCOLHA_2)            REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE NO ACTION;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_ESCOLHA_3)            REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE NO ACTION;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_ESCOLHA_4)            REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE NO ACTION;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_ESCOLHA_5)            REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE NO ACTION;
ALTER TABLE ITENS_REALIZA_SESSAO ADD  FOREIGN KEY(ITE_ESCOLHA_6)            REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE CASCADE ON DELETE NO ACTION;
ALTER TABLE ANAGRAMA_ESTIMULOS   ADD  FOREIGN KEY(ANA_EST_CODIGO)      		REFERENCES ANAGRAMAS (ANA_CODIGO)      ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE ANAGRAMA_ESTIMULOS   ADD  FOREIGN KEY(ANA_EST_ESTIMULO)    		REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE ANAGRAMA_ESTI_EXTRA  ADD  FOREIGN KEY(ANA_EST_EXT_CODIGO) 		REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE NO ACTION ON DELETE NO ACTION ;
ALTER TABLE ANAGRAMA_ESTI_EXTRA  ADD  FOREIGN KEY(ANA_EST_EXT_CODIGO) 		REFERENCES ESTIMULOS (EST_CODIGO)      ON UPDATE NO ACTION ON DELETE NO ACTION ;